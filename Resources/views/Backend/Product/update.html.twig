{% extends 'SyliusWebBundle:Backend:layout.html.twig' %}

{% block javascripts %}
{{ parent() }}
{% javascripts
    '@SyliusShippingBundle/Resources/assets/js/prototype-handler.js'
%}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}
<script type="text/javascript">
    $(document).ready(function() {
        $('a[data-collection-button="add"]').on('click', function (e) {
            var collectionContainer = $('#' + $(this).data('collection'));
            var lastElementNumber = (collectionContainer.children().length) - 1;
            $('#sylius_product_properties_' + lastElementNumber + ' .property-chooser').handlePrototypes({
                prototypePrefix: 'property-prototype',
                prototypeElementPrefix: '',
                containerSelector: '#sylius_product_properties_' + lastElementNumber + ' .control-group:last .controls'
            });
            $('#sylius_product_properties_' + lastElementNumber + ' .property-chooser').change(function() {
                $('#sylius_product_properties_' + lastElementNumber + ' .control-group:last .controls input').each(function() {
                    this.name = this.name.replace(/__name__/g, lastElementNumber);
                    this.id = this.id.replace(/__name__/g, lastElementNumber);
                });
            });
        });
    });
</script>
{% endblock %}

{% block content %}
<div class="page-header">
<h1>{{ 'sylius.backend.product.update_header'|trans|raw }}</h1>
</div>

<form action="{{ path('sylius_backend_product_update', {'id': product.id}) }}" method="post" class="form-horizontal" novalidate>
    <input type="hidden" name="_method" value="PUT">
    {% include 'SyliusWebBundle:Backend/Product:_form.html.twig' %}
    <div class="form-actions">
        <input type="submit" value="{{ 'sylius.backend.save_changes'|trans }}" class="btn btn-primary btn-large" />
        <a href="{{ path('sylius_backend_product_index') }}" class="btn btn-large">{{ 'sylius.backend.cancel'|trans }}</a>
    </div>
</form>
{% endblock %}
